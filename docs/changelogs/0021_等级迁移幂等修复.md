# 变更日志: 等级迁移幂等修复
**日期**: 2025-11-27 16:55
**任务**: 确保等级迁移脚本多次运行不会产生重复数据

## 📂 文件变更
### 修改 (Modified)
- `scripts/migrate-data.ts`: 在 `migrateGrades` 开头新增清理逻辑，迁移前执行 `client.grade.deleteMany({})` 并输出日志，确保等级数据幂等。

### 新增 (Created)
- `docs/changelogs/0021_等级迁移幂等修复.md`: 记录等级迁移幂等化的详情。

### 删除 (Deleted)
- 无

## 💡 技术说明 (Technical Notes)
- 等级数据量较小，采用全量覆盖策略最简单可靠；若后续需要增量迁移，可再引入主键对比逻辑。

